#!/usr/bin/env php
<?php
require __DIR__ . '/../vendor/autoload.php';

use FransIk\Certbot\TransipDns;

if (PHP_SAPI !== 'cli') {
    echo '[ERROR] transip-dns-cleanup should be invoked via the CLI' . PHP_EOL;
}

$domain = getenv('CERTBOT_DOMAIN');
$token = getenv('CERTBOT_VALIDATION');

$transipDns = new TransipDns($domain, $token);
$dnsEntries = $transipDns->removeChallengeRecord();
$transipDns->commit($dnsEntries, false);
echo 'The DNS-01 challenge has been successfully removed.' . PHP_EOL;
